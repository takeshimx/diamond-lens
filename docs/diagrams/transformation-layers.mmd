graph LR
    subgraph "Source - BigQuery Raw"
        S1[statcast_2021-2024<br/>_partitioned]
        S2[statcast_2025_staging]
        S3[dim_players]
        S4[fact_batting_stats<br/>_2025_weekly_staging]
        S5[fact_pitching_stats<br/>_2025_weekly_staging]
    end

    subgraph "Staging (VIEW)"
        ST1[stg_statcast_events<br/>Union 2021-2025]
        ST2[stg_batting_stats]
        ST3[stg_pitching_stats]
    end

    subgraph "Intermediate (VIEW)"
        INT1[int_statcast_risp_events]
        INT2[int_statcast_bases_loaded]
        INT3[int_statcast_runner_on_1b]
    end

    subgraph "Core (INCREMENTAL)"
        C1[fact_batting_stats_master<br/>Range partitioned by season]
        C2[fact_pitching_stats_master<br/>Range partitioned by season]
        C3[statcast_2025_partitioned<br/>Date partitioned]
    end

    subgraph "Marts (TABLE)"
        M1[tbl_batter_clutch_risp]
        M2[tbl_batter_clutch_bases_loaded]
        M3[tbl_batter_clutch_runner_on_1b]
        M4[tbl_batter_offensive_stats_monthly]
        M5[tbl_batter_performance_risp_monthly]
        M6[tbl_pitching_performance_by_inning]
    end

    S1 --> ST1
    S2 --> ST1
    S3 --> ST1
    S4 --> ST2
    S5 --> ST3

    ST1 --> INT1
    ST1 --> INT2
    ST1 --> INT3
    ST1 --> C3
    ST2 --> C1
    ST3 --> C2

    INT1 --> M1
    INT1 --> M5
    INT2 --> M2
    INT3 --> M3
    C1 --> M4
    C2 --> M6

    M1 --> API[Backend API]
    M2 --> API
    M3 --> API
    M4 --> API
    M5 --> API
    M6 --> API
